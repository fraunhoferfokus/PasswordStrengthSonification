<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>PWSon_Base.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module-scripts_EncryptedTransmission-EncryptedTransmission.html">EncryptedTransmission</a><ul class='methods'><li data-type='method'><a href="module-scripts_EncryptedTransmission-EncryptedTransmission.html#init">init</a></li><li data-type='method'><a href="module-scripts_EncryptedTransmission-EncryptedTransmission.html#updateSonification">updateSonification</a></li></ul></li><li><a href="module-scripts_InverseParkingSensor-InverseParkingSensor.html">InverseParkingSensor</a><ul class='methods'><li data-type='method'><a href="module-scripts_InverseParkingSensor-InverseParkingSensor.html#init">init</a></li><li data-type='method'><a href="module-scripts_InverseParkingSensor-InverseParkingSensor.html#updateSonification">updateSonification</a></li></ul></li><li><a href="module-scripts_NoiseToHarmonic-NoiseToHarmonic.html">NoiseToHarmonic</a><ul class='methods'><li data-type='method'><a href="module-scripts_NoiseToHarmonic-NoiseToHarmonic.html#init">init</a></li><li data-type='method'><a href="module-scripts_NoiseToHarmonic-NoiseToHarmonic.html#updateSonification">updateSonification</a></li></ul></li><li><a href="module-scripts_PasswordChecker-PasswordChecker.html">PasswordChecker</a><ul class='methods'><li data-type='method'><a href="module-scripts_PasswordChecker-PasswordChecker.html#checkPwd">checkPwd</a></li><li data-type='method'><a href="module-scripts_PasswordChecker-PasswordChecker.html#init">init</a></li></ul></li><li><a href="module-scripts_PWSon_Base-PWSon_Base.html">PWSon_Base</a><ul class='methods'><li data-type='method'><a href="module-scripts_PWSon_Base-PWSon_Base.html#init">init</a></li><li data-type='method'><a href="module-scripts_PWSon_Base-PWSon_Base.html#muteAudio">muteAudio</a></li><li data-type='method'><a href="module-scripts_PWSon_Base-PWSon_Base.html#playCommonPWEventSound">playCommonPWEventSound</a></li><li data-type='method'><a href="module-scripts_PWSon_Base-PWSon_Base.html#setAudioOutput">setAudioOutput</a></li><li data-type='method'><a href="module-scripts_PWSon_Base-PWSon_Base.html#updateSonification">updateSonification</a></li></ul></li><li><a href="module-scripts_PWSon_DroneSynth-PWSon_DroneSynth.html">PWSon_DroneSynth</a><ul class='methods'><li data-type='method'><a href="module-scripts_PWSon_DroneSynth-PWSon_DroneSynth.html#enableMajorScale">enableMajorScale</a></li><li data-type='method'><a href="module-scripts_PWSon_DroneSynth-PWSon_DroneSynth.html#getOutput">getOutput</a></li><li data-type='method'><a href="module-scripts_PWSon_DroneSynth-PWSon_DroneSynth.html#play">play</a></li><li data-type='method'><a href="module-scripts_PWSon_DroneSynth-PWSon_DroneSynth.html#stop">stop</a></li></ul></li><li><a href="module-scripts_SonificationGroup-SonificationGroup.html">SonificationGroup</a><ul class='methods'><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#addSonification">addSonification</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#initAllSonifications">initAllSonifications</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#muteAudio">muteAudio</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#playCommonPWEventSound">playCommonPWEventSound</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#selectSonificationByDescription">selectSonificationByDescription</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#selectSonificationByIndex">selectSonificationByIndex</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#selectSonificationByObject">selectSonificationByObject</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#setAllEnableGradualVolumeAtFewCharacters">setAllEnableGradualVolumeAtFewCharacters</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#setAllFadeInCharacters">setAllFadeInCharacters</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#setAllGoodEnoughThreshold">setAllGoodEnoughThreshold</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#setAllReversePolarity">setAllReversePolarity</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#updateSonification">updateSonification</a></li></ul></li><li><a href="module-scripts_TwoTones-TwoTones.html">TwoTones</a><ul class='methods'><li data-type='method'><a href="module-scripts_TwoTones-TwoTones.html#updateSonification">updateSonification</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-scripts_EncryptedTransmission.html">scripts/EncryptedTransmission</a></li><li><a href="module-scripts_InverseParkingSensor.html">scripts/InverseParkingSensor</a></li><li><a href="module-scripts_NoiseToHarmonic.html">scripts/NoiseToHarmonic</a></li><li><a href="module-scripts_PasswordChecker.html">scripts/PasswordChecker</a></li><li><a href="module-scripts_PWSon_Base.html">scripts/PWSon_Base</a></li><li><a href="module-scripts_PWSon_DroneSynth.html">scripts/PWSon_DroneSynth</a></li><li><a href="module-scripts_PWSon_HelperFunctions.html">scripts/PWSon_HelperFunctions</a><ul class='methods'><li data-type='method'><a href="module-scripts_PWSon_HelperFunctions.html#~attachScriptToHead">attachScriptToHead</a></li><li data-type='method'><a href="module-scripts_PWSon_HelperFunctions.html#~loadScript">loadScript</a></li><li data-type='method'><a href="module-scripts_PWSon_HelperFunctions.html#~rand">rand</a></li><li data-type='method'><a href="module-scripts_PWSon_HelperFunctions.html#~scaleBetweenTwoRanges">scaleBetweenTwoRanges</a></li></ul></li><li><a href="module-scripts_PWSon_SoundFilePaths.html">scripts/PWSon_SoundFilePaths</a></li><li><a href="module-scripts_SonificationGroup.html">scripts/SonificationGroup</a></li><li><a href="module-scripts_TwoTones.html">scripts/TwoTones</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">PWSon_Base.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** 
 * Password Sonification base module
 * @module
 * @author Otto Hans-Martin Lutz &lt;otto.lutz@fokus.fraunhofer.de>
 */
import { isBoolean } from './PWSon_HelperFunctions.js'
import { convolutionReverbFile, commonPWNotificationFile } from './PWSon_SoundFilePaths.js'
import 'https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.12/Tone.js'
export { PWSon_Base }

/**
 * Base class for all password sonifications
 */
class PWSon_Base {
    /** create a password sonification object
     * @param {object=} audioOutput audio output object (if not Tone.Master)
     */
    constructor(audioOutput = null) {
        /* state properties */
        this.currentScore = 0
        this.lastNumberCharacters = 0

        /* main property settings */
        this.enableCommonPWCheck = true
        this._goodEnoughThreshold = 7
        this.reverbWetAmountAfterGoodEnoughScore = 0.33
        this._enableGradualVolumeAtFewCharacters = false
        this._fadeInCharacters = 4
        this._reversePolarity = false
        //this.transferFunction = "linear"

        /* initialize main Tone.js components */
        if (audioOutput != null) {
            this.audioOutput = audioOutput
        } else {
            this.audioOutput = Tone.Master
        }
        this.volume = new Tone.Volume().connect(this.audioOutput)
        this.reverb = new Tone.Convolver(convolutionReverbFile).connect(this.volume)
        this.reverb.wet.value = 0
        this.commonPwdPlayer = new Tone.Player(commonPWNotificationFile).connect(this.volume);
        this.commonPwdPlayer.volume.value = -3
    }

    /** initialize password sonification */
    init() {
        Tone.Transport.start()
    }

    /** update password sonification with new score
     * @param {number} score score, between 0 and 10
     * @param {numberCharacters=} numberCharacters number of characters typed (for gradual fade-in)
    */
    updateSonification(score = this.currentScore, numberCharacters = this.lastNumberCharacters) {
        if (score &lt; 0 || score > 10) throw Error('updateSonification: parameter score of ' + score.toString() + ' is not in allowed range 0...10')

        if (this._reversePolarity) score = 10 - score
        this.currentScore = score

        this.lastNumberCharacters = numberCharacters
        if (this._enableGradualVolumeAtFewCharacters) {
            if (numberCharacters > this._fadeInCharacters) {
                this.volume.volume.value = 0
            }
            else {
                this.volume.volume.value = 2.0 * this._fadeInCharacters * (-this._fadeInCharacters + numberCharacters) // 2dB attenuation per fade in character
            }
        }
    }
    /** play sound to indicate a common password */
    playCommonPWEventSound() {
        this.commonPwdPlayer.restart()
    }

    /** set audio output of this sonification (useful for use within SonificationGroups) 
     * @param {Object} audioOutput the audio output object
    */
    setAudioOutput(audioOutput) {
        this.volume.disconnect(this.audioOutput)
        this.audioOutput = audioOutput
        this.volume.connect(this.audioOutput)
    }

    /** mute / unmute audio 
     * @param {boolean} mute mute audio
    */
    muteAudio(mute) {
        if (!isBoolean(mute)) throw Error('muteAudio: parameter must be boolean')
        this.volume.mute = mute
    }


    /* ----- Getters/Setters ----- */

    /** get if gradual volume fade-in at the first few characters is enabled */
    get enableGradualVolumeAtFewCharacters() { return this._enableGradualVolumeAtFewCharacters }
    /** enable/disable gradual volume fade-in at the first few characters 
     * @type {boolean} 
    */
    set enableGradualVolumeAtFewCharacters(enableFadeIn) {
        if (!isBoolean(enableFadeIn)) throw Error('enableGradualVolumeAtFewCharacters: parameter must be boolean')
        this._enableGradualVolumeAtFewCharacters = enableFadeIn
        if (!this._enableGradualVolumeAtFewCharacters) this.volume.volume.value = 0
        this.updateSonification()
    }

    /** get the number of characters, to which the volume is faded in */
    get fadeInCharacters() { return this._fadeInCharacters }
    /** set the number of characters, to which the volume is faded in
     * @type {number}
     */
    set fadeInCharacters(numberCharacters) {
        if (!(Number.isInteger(numberCharacters) &amp;&amp; numberCharacters > 0)) throw Error('fadeInCharacters: parameter numberCharacters must be a positive Integer')
        this._fadeInCharacters = numberCharacters
        this.updateSonification()
    }

    /** get the password score threshold, after which a password is considered 'good enough' */
    get goodEnoughThreshold() { return this._goodEnoughThreshold }
    /** set the password score threshold, after which a password is considered 'good enough'
     * @type {number}
     */
    set goodEnoughThreshold(threshold) {
        if (isNaN(threshold)) throw Error('goodEnoughThreshold: parameter mus be a number')
        this._goodEnoughThreshold = threshold
        this.updateSonification()
    }

    /** get if the mapping polarity (score to sound) is reversed, i.e. at a score of 0, the sound for score 10 is played (and vice versa) */
    get reversePolarity() { return this._reversePolarity }
    /** set if the mapping polarity (score to sound) is reversed, i.e. at a score of 0, the sound for score 10 is played (and vice versa)
     * @type {boolean} 
    */
    set reversePolarity(reverse) {
        if (!isBoolean(reverse)) throw Error('reversePolarity: parameter must be boolean')
        this._reversePolarity = reverse
        // if polarity was reversed and is set back to normal, reverse the last saved current score back to normal as well
        if (!this._reversePolarity) this.currentScore = 10 - this.currentScore
        this.updateSonification()
    }
}</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Wed Jul 01 2020 19:39:13 GMT+0200 (GMT+02:00) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
