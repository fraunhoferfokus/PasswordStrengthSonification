<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>SonificationGroup.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module-scripts_EncryptedTransmission-EncryptedTransmission.html">EncryptedTransmission</a><ul class='methods'><li data-type='method'><a href="module-scripts_EncryptedTransmission-EncryptedTransmission.html#init">init</a></li><li data-type='method'><a href="module-scripts_EncryptedTransmission-EncryptedTransmission.html#updateSonification">updateSonification</a></li></ul></li><li><a href="module-scripts_InverseParkingSensor-InverseParkingSensor.html">InverseParkingSensor</a><ul class='methods'><li data-type='method'><a href="module-scripts_InverseParkingSensor-InverseParkingSensor.html#init">init</a></li><li data-type='method'><a href="module-scripts_InverseParkingSensor-InverseParkingSensor.html#updateSonification">updateSonification</a></li></ul></li><li><a href="module-scripts_NoiseToHarmonic-NoiseToHarmonic.html">NoiseToHarmonic</a><ul class='methods'><li data-type='method'><a href="module-scripts_NoiseToHarmonic-NoiseToHarmonic.html#init">init</a></li><li data-type='method'><a href="module-scripts_NoiseToHarmonic-NoiseToHarmonic.html#updateSonification">updateSonification</a></li></ul></li><li><a href="module-scripts_PasswordChecker-PasswordChecker.html">PasswordChecker</a><ul class='methods'><li data-type='method'><a href="module-scripts_PasswordChecker-PasswordChecker.html#checkPwd">checkPwd</a></li><li data-type='method'><a href="module-scripts_PasswordChecker-PasswordChecker.html#init">init</a></li></ul></li><li><a href="module-scripts_PWSon_Base-PWSon_Base.html">PWSon_Base</a><ul class='methods'><li data-type='method'><a href="module-scripts_PWSon_Base-PWSon_Base.html#init">init</a></li><li data-type='method'><a href="module-scripts_PWSon_Base-PWSon_Base.html#muteAudio">muteAudio</a></li><li data-type='method'><a href="module-scripts_PWSon_Base-PWSon_Base.html#playCommonPWEventSound">playCommonPWEventSound</a></li><li data-type='method'><a href="module-scripts_PWSon_Base-PWSon_Base.html#setAudioOutput">setAudioOutput</a></li><li data-type='method'><a href="module-scripts_PWSon_Base-PWSon_Base.html#updateSonification">updateSonification</a></li></ul></li><li><a href="module-scripts_PWSon_DroneSynth-PWSon_DroneSynth.html">PWSon_DroneSynth</a><ul class='methods'><li data-type='method'><a href="module-scripts_PWSon_DroneSynth-PWSon_DroneSynth.html#enableMajorScale">enableMajorScale</a></li><li data-type='method'><a href="module-scripts_PWSon_DroneSynth-PWSon_DroneSynth.html#getOutput">getOutput</a></li><li data-type='method'><a href="module-scripts_PWSon_DroneSynth-PWSon_DroneSynth.html#play">play</a></li><li data-type='method'><a href="module-scripts_PWSon_DroneSynth-PWSon_DroneSynth.html#stop">stop</a></li></ul></li><li><a href="module-scripts_SonificationGroup-SonificationGroup.html">SonificationGroup</a><ul class='methods'><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#addSonification">addSonification</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#initAllSonifications">initAllSonifications</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#muteAudio">muteAudio</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#playCommonPWEventSound">playCommonPWEventSound</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#selectSonificationByDescription">selectSonificationByDescription</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#selectSonificationByIndex">selectSonificationByIndex</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#selectSonificationByObject">selectSonificationByObject</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#setAllEnableGradualVolumeAtFewCharacters">setAllEnableGradualVolumeAtFewCharacters</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#setAllFadeInCharacters">setAllFadeInCharacters</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#setAllGoodEnoughThreshold">setAllGoodEnoughThreshold</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#setAllReversePolarity">setAllReversePolarity</a></li><li data-type='method'><a href="module-scripts_SonificationGroup-SonificationGroup.html#updateSonification">updateSonification</a></li></ul></li><li><a href="module-scripts_TwoTones-TwoTones.html">TwoTones</a><ul class='methods'><li data-type='method'><a href="module-scripts_TwoTones-TwoTones.html#updateSonification">updateSonification</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-scripts_EncryptedTransmission.html">scripts/EncryptedTransmission</a></li><li><a href="module-scripts_InverseParkingSensor.html">scripts/InverseParkingSensor</a></li><li><a href="module-scripts_NoiseToHarmonic.html">scripts/NoiseToHarmonic</a></li><li><a href="module-scripts_PasswordChecker.html">scripts/PasswordChecker</a></li><li><a href="module-scripts_PWSon_Base.html">scripts/PWSon_Base</a></li><li><a href="module-scripts_PWSon_DroneSynth.html">scripts/PWSon_DroneSynth</a></li><li><a href="module-scripts_PWSon_HelperFunctions.html">scripts/PWSon_HelperFunctions</a><ul class='methods'><li data-type='method'><a href="module-scripts_PWSon_HelperFunctions.html#~attachScriptToHead">attachScriptToHead</a></li><li data-type='method'><a href="module-scripts_PWSon_HelperFunctions.html#~loadScript">loadScript</a></li><li data-type='method'><a href="module-scripts_PWSon_HelperFunctions.html#~rand">rand</a></li><li data-type='method'><a href="module-scripts_PWSon_HelperFunctions.html#~scaleBetweenTwoRanges">scaleBetweenTwoRanges</a></li></ul></li><li><a href="module-scripts_PWSon_SoundFilePaths.html">scripts/PWSon_SoundFilePaths</a></li><li><a href="module-scripts_SonificationGroup.html">scripts/SonificationGroup</a></li><li><a href="module-scripts_TwoTones.html">scripts/TwoTones</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">SonificationGroup.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** 
 * Sonification Group module
 * @module
 * @author Otto Hans-Martin Lutz &lt;otto.lutz@fokus.fraunhofer.de>
 */
import { isBoolean } from './PWSon_HelperFunctions.js'
import { PWSon_Base } from './PWSon_Base.js'
import 'https://cdnjs.cloudflare.com/ajax/libs/tone/13.8.25/Tone.js'
export { SonificationGroup }

/**
 * Sonification group to select and switch between several sonifications
 */
class SonificationGroup {
    /** create a SonificationGroup object
     * @param {object=} audioOutput audio output object (if not Tone.Master)
     */
    constructor(audioOutput = null) {
        if (audioOutput != null) {
            this.audioOutput = audioOutput
        } else {
            this.audioOutput = Tone.Master
        }
        this.volume = new Tone.Volume().connect(this.audioOutput)

        this.currentScore = 0
        this.lastNumberCharacters = 0
        this.list = []
    }


    /** add a sonification to the sonification group 
     * @param {Object} sonification the sonification object to add, instance of / inheriting from PWSon_Base
     * @param {string} description description of the sonification (e.g., its name and/or configured parameters)
     */
    addSonification(sonification, description) {
        let son = new SonificationItem(sonification, description)
        son.volume.mute = true
        son.sonification.setAudioOutput(son.volume)
        son.volume.connect(this.volume)
        this.list.push(son)
    }

    /** initialize all sonifications of the sonification group */
    initAllSonifications() {
        this.list.forEach(element => { element.sonification.init() })
    }

    /** select the currently active (volume unmuted) sonification 
     * @param {Object} sonification the sonification object 
     * @throws {Error} Error if sonification object is not found in the group or if it is not extending PWSon_Base
    */
    selectSonificationByObject(sonification) {
        if (sonification instanceof PWSon_Base) {
            // search for the first index of the exact object
            let found = this.list.findIndex(element => { element.sonification === sonification })
            if (found != -1) {
                selectSonificationByIndex(found)
            } else { throw Error('selectSonificationByObject: sonification object not found') }
        } else { throw Error('selectSonificationByObject: sonification object needs to be instance of PWSon_Base or extending PWSon_Base') }
    }

    /** select the currently active (volume unmuted) sonification 
     * @param {string} description the description string of the sonification object 
    */
    selectSonificationByDescription(description) {
        // search for the first index with the given description
        let found = this.list.findIndex(element => { element.description == description })
        if (found != -1) {
            selectSonificationByIndex(found)
        } else { throw Error('selectSonificationByDescription: sonification with the given description not found') }

    }

    /** select the currently active (volume unmuted) sonification 
     * @param {number} number the number of the sonification object in the list
    */
    selectSonificationByIndex(number) {
        if (isNaN(number)) throw Error('selectSonificationByIndex: index must be a number')
        if (number &lt; this.list.length) {
            // mute all sonifications, then unmute the selected one
            this.list.map(son => { son.volume.mute = true })
            this.list[number].volume.mute = false
        } else throw Error('selectSonificationByIndex: index of ' + number + ' is too large')

    }

    /** update password sonification with new score
     * @param {number=} score score, between 0 and 10
     * @param {numberCharacters=} numberCharacters number of characters typed (for gradual fade-in)
    */
    updateSonification(score = this.currentScore, numberCharacters = this.lastNumberCharacters) {
        this.currentScore = score
        this.lastNumberCharacters = numberCharacters
        this.list.map(son => { son.sonification.updateSonification(this.currentScore, this.lastNumberCharacters) })
    }

    /** play sound to indicate a common password */
    playCommonPWEventSound() {
        this.list.map(son => { son.sonification.playCommonPWEventSound() })
    }

    /* set audio output of this SonificationGroup */
    setAudioOutput(audioOutput) {
        this.volume.disconnect(this.audioOutput)
        this.audioOutput = audioOutput
        this.volume.connect(this.audioOutput)
    }

    /** mute / unmute audio 
     * @param {boolean} mute mute audio
    */
    muteAudio(mute) {
        if (!isBoolean(mute)) throw Error('muteAudio: parameter must be boolean')
        this.volume.mute = mute
    }

    /** for all sonifications in this group, enable/disable gradual volume fade-in at the first few characters 
     * @type {boolean} 
    */
    setAllEnableGradualVolumeAtFewCharacters(enableFadeIn) {
        this.list.map(son => { son.sonification.enableGradualVolumeAtFewCharacters = enableFadeIn })
    }

    /** for all sonifications in this group, set the number of characters, to which the volume is faded in
     * @type {number}
     */
    setAllFadeInCharacters(numberCharacters) {
        this.list.map(son => { son.sonification.fadeInCharacters = numberCharacters })
    }

    /** for all sonifications in this group, set the password score threshold, after which a password is considered 'good enough'
     * @type {number}
     */
    setAllGoodEnoughThreshold(threshold) {
        this.list.map(son => { son.sonification.goodEnoughThreshold = threshold })
    }

    /** for all sonifications in this group, set if the mapping polarity (score to sound) is reversed, i.e. at a score of 0, the sound for score 10 is played (and vice versa)
    * @type {boolean} 
    */
    setAllReversePolarity(reverse) {
        this.list.map(son => { son.sonification.reversePolarity = reverse })
    }
}


/** Sonification item 
 * @private
*/
class SonificationItem {
    /** create a sonification item. It contains an additional volume control for mixing/selection within the sonification group
     * @param {Object} sonification the sonification object, instance of / inheriting from PWSon_Base
     * @param {string} description description of the object (e.g., name of the sonification and/or configured parameters)
    */
    constructor(sonification, description) {
        this.sonification = sonification
        this.description = description
        this.volume = new Tone.Volume()
    }
}</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Wed Jul 01 2020 20:18:06 GMT+0200 (GMT+02:00) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
